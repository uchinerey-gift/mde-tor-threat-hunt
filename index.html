<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Unauthorized TOR Usage Lab</title>

    <link rel="icon" type="image/svg+xml" href="assets/favicon.svg">
    <link rel="stylesheet" href="css/style.css" />
</head>

<body>
    <header>
        <div class="inner">
            <img class="logo" src="assets/tor-logo.svg" alt="TOR Threat Hunt logo" />

            <h1>üïµüèæ‚Äç‚ôÄÔ∏è Microsoft Defender Advanced Hunting ‚Äî Unauthorized TOR Usage Lab</h1>

            <p class="subtitle">
                End-to-end threat hunting case study: TOR download, silent install, execution, network activity, and
                basic anti-forensics on a Windows 11 endpoint.
            </p>

            <div class="badge-row">
                <img src="https://img.shields.io/badge/TOR%20Threat%20Hunt-Complete-brightgreen"
                    alt="TOR Threat Hunt Complete">
                <img src="https://img.shields.io/badge/Platform-Microsoft%20Defender-blue"
                    alt="Platform Microsoft Defender">
                <img src="https://img.shields.io/badge/Tools-KQL%20%7C%20PowerShell-orange"
                    alt="Tools KQL and PowerShell">
                <img src="https://img.shields.io/badge/Focus-Threat%20Hunting%20%7C%20EDR-lightgrey"
                    alt="Focus Threat Hunting EDR">
            </div>
        </div>
    </header>

    <div class="hero-divider"></div>

    <main class="page-wrapper">

        <section class="section-card" id="overview" tabindex="0">
            <h2>üìå Overview</h2>
            <p>
                This project demonstrates how unauthorized TOR Browser usage appears in Microsoft Defender for Endpoint
                (MDE)
                telemetry and how to hunt for it using Advanced Hunting (KQL).
            </p>
            <p class="tagline">
                Goal: demonstrate real SOC-style investigation, evidence collection, and documentation skills.
            </p>
        </section>

        <section class="section-card" id="environment" tabindex="0">
            <h2>üß∞ Environment</h2>
            <ul class="meta-list">
                <li><strong>Endpoint:</strong> Windows 11 VM (<code>chi-chi-vm</code>)</li>
                <li><strong>Telemetry Platform:</strong> Microsoft Defender for Endpoint</li>
                <li><strong>Hunting Tool:</strong> Advanced Hunting (KQL)</li>
                <li><strong>Key Tables:</strong> <code>DeviceInfo</code>, <code>DeviceFileEvents</code>,
                    <code>DeviceProcessEvents</code>, <code>DeviceNetworkEvents</code></li>
            </ul>
        </section>

        <section class="section-card">
            <h2>üß≠ Investigation Scope & Coverage</h2>
            <p>
                This investigation focused on identifying unauthorized anonymization software usage on a managed Windows
                endpoint by validating telemetry coverage across file, process, and network activity.
            </p>
            <ul class="meta-list">
                <li><strong>File Activity:</strong> TOR installer download, artifact creation, and deletion</li>
                <li><strong>Process Activity:</strong> Silent installation execution and TOR Browser launch</li>
                <li><strong>Network Activity:</strong> TOR-related outbound connections over known TOR ports</li>
                <li><strong>Anti-Forensics:</strong> Creation and removal of a suspicious local file</li>
            </ul>
        </section>


        <section class="section-card" id="phase1" tabindex="0">
            <h2>üî• Phase 1 ‚Äî Simulated Unauthorized TOR Activity</h2>
            <p class="muted">
                Each step includes: what/why, PowerShell activity generation, PowerShell evidence, KQL query, and KQL
                results evidence.
            </p>
        </section>

        <!-- STEP 1 -->
        <section class="section-card" id="step-1" tabindex="0">
            <h3>1.1 Validate Device Visibility</h3>
            <p>Confirmed the endpoint is visible and actively reporting to ensure telemetry capture.</p>

            <p><strong>PowerShell Commands</strong></p>
            <pre><code class="language-powershell"># Validation performed in Microsoft Defender portal (no local command)</code></pre>

            <p><strong>PowerShell Evidence Screenshot</strong></p>
            <img src="evidence/screenshots/01_MDE_Device_Visible_In_Defender_Portal.png" width="800"
                alt="Device visible in Defender portal">

            <p><strong>KQL Query</strong></p>
            <pre><code class="language-kql">DeviceInfo
| project Timestamp, DeviceName, OnboardingStatus, SensorHealthState
| order by Timestamp desc</code></pre>

            <p><strong>KQL Results Screenshot</strong> ‚Äî <code>KQL_DeviceInfo_Device_Visibility</code></p>
            <img src="report/09_KQL_DeviceInfo_Device_Visibility.png" width="800" alt="KQL results - Device visibility">
        </section>

        <!-- STEP 2 -->
        <section class="section-card" id="step-2" tabindex="0">
            <h3>1.2 Confirm Defender Sensor Running</h3>
            <p>Verified the Defender Sense service is running to confirm telemetry ingestion.</p>

            <p><strong>PowerShell Commands</strong></p>
            <pre><code class="language-powershell">Get-Service -Name Sense</code></pre>

            <p><strong>PowerShell Evidence Screenshot</strong></p>
            <img src="evidence/screenshots/02_Windows_Sense_Service_Running.png" width="800"
                alt="Sense service running">

            <p><strong>KQL Query</strong></p>
            <pre><code class="language-kql">DeviceInfo
| project Timestamp, DeviceName, SensorHealthState
| order by Timestamp desc</code></pre>

            <p><strong>KQL Results Screenshot</strong> ‚Äî <code>KQL_DeviceInfo_Sensor_Health</code></p>
            <img src="report/10_KQL_DeviceInfo_Sensor_Health.png" width="800" alt="KQL results - Sensor health">
        </section>

        <!-- STEP 3 -->
        <section class="section-card" id="step-3" tabindex="0">
            <h3>1.3 Download TOR Installer</h3>
            <p>Downloaded the TOR Browser installer to generate file telemetry.</p>

            <p><strong>PowerShell Commands</strong></p>
            <pre><code class="language-powershell"># TOR installer downloaded via browser</code></pre>

            <p><strong>PowerShell Evidence Screenshot</strong></p>
            <img src="evidence/screenshots/03_TOR_Installer_Downloaded_In_Downloads.png" width="800"
                alt="TOR installer downloaded">

            <p><strong>KQL Query</strong></p>
            <pre><code class="language-kql">DeviceFileEvents
| where FileName startswith "tor-browser-windows"
| project Timestamp, DeviceName, ActionType, FileName, FolderPath
| order by Timestamp desc</code></pre>

            <p><strong>KQL Results Screenshot</strong> ‚Äî <code>KQL_DeviceFileEvents_TOR_Installer_Download</code>
            </p>
            <img src="report/11_KQL_DeviceFileEvents_TOR_Installer_Download.png" width="800"
                alt="KQL results - TOR installer download">
        </section>

        <!-- STEP 4 -->
        <section class="section-card" id="step-4" tabindex="0">
            <h3>1.4 Confirm Installer Filename</h3>
            <p>Confirmed exact installer filename to ensure accurate hunting.</p>

            <p><strong>PowerShell Commands</strong></p>
            <pre><code class="language-powershell"># Verified installer filename in Downloads</code></pre>

            <p><strong>PowerShell Evidence Screenshot</strong></p>
            <img src="evidence/screenshots/04_TOR_Installer_Filename_Confirmed.png" width="800"
                alt="Installer filename confirmed">

            <p><strong>KQL Query</strong></p>
            <pre><code class="language-kql">DeviceFileEvents
| where FileName contains "tor-browser"
| project Timestamp, DeviceName, FileName, FolderPath
| order by Timestamp desc</code></pre>

            <p><strong>KQL Results Screenshot</strong> ‚Äî <code>KQL_DeviceFileEvents_TOR_Installer_Filename</code>
            </p>
            <img src="report/12_KQL_DeviceFileEvents_TOR_Installer_Filename.png" width="800"
                alt="KQL results - TOR installer filename">
        </section>

        <!-- STEP 5 -->
        <section class="section-card" id="step-5" tabindex="0">
            <h3>1.5 Execute Silent Install</h3>
            <p>Executed a silent installation to simulate unauthorized software deployment.</p>

            <p><strong>PowerShell Commands</strong></p>
            <pre><code class="language-powershell">tor-browser-windows-x86_64-portable-15.0.3.exe  /S</code></pre>

            <p><strong>PowerShell Evidence Screenshot</strong></p>
            <img src="evidence/screenshots/05_TOR_Silent_Install_Command_Executed.png" width="800"
                alt="Silent install executed">

            <p><strong>KQL Query</strong></p>
            <pre><code class="language-kql">DeviceProcessEvents
| where ProcessCommandLine has "tor-browser-windows"
| where ProcessCommandLine has "/S"
| project Timestamp, DeviceName, AccountName, FileName, ProcessCommandLine
| order by Timestamp desc</code></pre>

            <p><strong>KQL Results Screenshot</strong> ‚Äî <code>KQL_DeviceProcessEvents_TOR_Silent_Install</code>
            </p>
            <img src="report/13_KQL_DeviceProcessEvents_TOR_Silent_Install.png" width="800"
                alt="KQL results - TOR silent install">
        </section>

        <!-- STEP 6 -->
        <section class="section-card" id="step-6" tabindex="0">
            <h3>1.6 Launch TOR Browser</h3>
            <p>Launched TOR to generate process execution telemetry.</p>

            <p><strong>PowerShell Commands</strong></p>
            <pre><code class="language-powershell"># Launched TOR Browser frome the extracted folder</code></pre>

            <p><strong>PowerShell Evidence Screenshot</strong></p>
            <img src="evidence/screenshots/06_TOR_Browser_Launched.png" width="800" alt="TOR browser launched">

            <p><strong>KQL Query</strong></p>
            <pre><code class="language-kql">DeviceProcessEvents
| where FileName in~ ("tor.exe","firefox.exe")
| project Timestamp, DeviceName, AccountName, FileName, ProcessCommandLine
| order by Timestamp desc</code></pre>

            <p><strong>KQL Results Screenshot</strong> ‚Äî <code>KQL_DeviceProcessEvents_TOR_Launch</code></p>
            <img src="report/14_KQL_DeviceProcessEvents_TOR_Launch.png" width="800" alt="KQL results - TOR launch">
        </section>

        <!-- STEP 7 -->
        <section class="section-card" id="step-7" tabindex="0">
            <h3>1.7 Generate TOR Network Activity</h3>
            <p>Generated anonymized network connections through TOR.</p>

            <p><strong>PowerShell Commands</strong></p>
            <pre><code class="language-powershell"># Browsing activity through TOR</code></pre>

            <p><strong>PowerShell Evidence Screenshot</strong></p>
            <img src="evidence/screenshots/07_TOR_Network_Activity_Generated.png" width="800"
                alt="TOR network activity generated">

            <p><strong>KQL Query</strong></p>
            <pre><code class="language-kql">DeviceNetworkEvents
| where InitiatingProcessFileName in~ ("tor.exe", "firefox.exe")
| where RemotePort in (9001,9030,9040,9050,9051,9150)
| project Timestamp, DeviceName, InitiatingProcessAccountName, InitiatingProcessFileName, RemoteIP, RemotePort, RemoteUrl
| order by Timestamp desc</code></pre>

            <p><strong>KQL Results Screenshot</strong> ‚Äî
                <code>KQL_DeviceNetworkEvents_TOR_Network_Activity</code></p>
            <img src="report/15_KQL_DeviceNetworkEvents_TOR_Network_Activity.png" width="800"
                alt="KQL results - TOR network activity">
        </section>

        <!-- STEP 8 -->
        <section class="section-card" id="step-8" tabindex="0">
            <h3>1.8 Create and Delete Suspicious File</h3>
            <p>Created and deleted a file to simulate basic anti-forensics behavior.</p>

            <p><strong>PowerShell Commands</strong></p>
            <pre><code class="language-powershell">cd $env:USERPROFILE\Desktop
New-Item -Name "tor-shopping-list.txt" -ItemType File
Add-Content -Path "tor-shopping-list.txt" -Value "fake item 1"
Add-Content -Path "tor-shopping-list.txt" -Value "fake item 2"
Remove-Item -Path "tor-shopping-list.txt"</code></pre>

            <p><strong>PowerShell Evidence Screenshot</strong></p>
            <img src="evidence/screenshots/08-09_TOR_Shopping_List_File_Create_Modify_Delete_PowerShell.png" width="800"
                alt="Shopping list file activity">

            <p><strong>KQL Query</strong></p>
            <pre><code class="language-kql">DeviceFileEvents
| where FileName == "tor-shopping-list.txt"
| project Timestamp, DeviceName, ActionType, FileName, FolderPath, InitiatingProcessFileName, InitiatingProcessCommandLine
| order by Timestamp desc</code></pre>

            <p><strong>KQL Results Screenshot</strong> ‚Äî
                <code>KQL_DeviceFileEvents_Shopping_List_FileEvents</code></p>
            <img src="report/16_KQL_DeviceFileEvents_Shopping_List_FileEvents.png" width="800"
                alt="KQL results - shopping list file events">
        </section>

    </main>

    <footer class="footer">
        <p>¬© Chinerey Ukwu ‚Äî Cybersecurity Portfolio</p>
    </footer>
</body>

</html>